-- Create core compute and database structures
CREATE WAREHOUSE IF NOT EXISTS WH_XS WITH
	WAREHOUSE_SIZE = 'XSMALL'
	AUTO_SUSPEND = 60
	AUTO_RESUME = TRUE
	INITIALLY_SUSPENDED = TRUE;

CREATE DATABASE IF NOT EXISTS DM_DEMO;
USE DATABASE DM_DEMO;

CREATE SCHEMA IF NOT EXISTS RAW;

-- Default context
USE WAREHOUSE WH_XS;
USE SCHEMA RAW;

-- File format for CSVs generated by the Python generator
CREATE OR REPLACE FILE FORMAT FF_CSV
	TYPE = 'CSV'
	FIELD_DELIMITER = ','
	SKIP_HEADER = 1
	FIELD_OPTIONALLY_ENCLOSED_BY = '"'
	NULL_IF = ('', 'NULL', 'null');

-- Internal stage for loading files from local via PUT
CREATE STAGE IF NOT EXISTS RAW_STAGE
	FILE_FORMAT = FF_CSV
	DIRECTORY = (ENABLE = TRUE); 